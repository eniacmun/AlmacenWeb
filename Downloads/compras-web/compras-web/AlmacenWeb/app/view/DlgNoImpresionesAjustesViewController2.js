/*
 * File: app/view/DlgNoImpresionesAjustesViewController2.js
 *
 * This file was generated by Sencha Architect version 3.2.0.
 * http://www.sencha.com/products/architect/
 *
 * This file requires use of the Ext JS 5.0.x library, under independent license.
 * License of Sencha Architect does not include license for Ext JS 5.0.x. For more
 * details see http://www.sencha.com/license or contact license@sencha.com.
 *
 * This file will be auto-generated each and everytime you save your project.
 *
 * Do NOT hand edit this file.
 */

Ext.define('almacen.view.DlgNoImpresionesAjustesViewController2', {
    extend: 'Ext.app.ViewController',
    alias: 'controller.dlgmotivosordencompleta',

    control: {
        "button#btnAceptar2": {
            click: 'AsignarPreguntaMotivos'
        },
        "#cmbNoImpresiones2": {
            afterrender: 'PreguntaMotivos'
        }
    },

    AsignarPreguntaMotivos: function(button, e, eOpts) {
        var motivo = Ext.ComponentMgr.get("cmbNoImpresiones2").getValue();

        console.log("motivo");
        console.log(motivo);
        console.log(motivo.length);


        if(motivo.trim().length < 1){
            return;
        }

        this.AsignaMotivo(motivo);

    },

    PreguntaMotivos: function(component, eOpts) {
        var request = {}; request.method="obtienemotivosorden"; request.params=[];
        request.params.push({"name":"imei","value":almacen.getApplication().SessionId});


        almacen.getApplication().loadData(request,function(response){
            console.log("response --");
            console.log(response);

            component.getStore().removeAll();

            if(response.length > 0 ){

                for(var i = 0; i < response.length ; i++){
                    var user = Ext.create('almacen.model.mdlGeneric', {
                        value   : response[i],
                        label : response[i]
                    });
                    component.getStore().add(user);
                }

              //  component.setValue(response[0]);
                component.getStore().sort("label","ASC");
            }
        });

    },

    AsignaMotivo: function(motivo) {
                Ext.WindowMgr.get("wndPreguntaMotivoIncompleta").parentController.recibePedido(motivo);
                Ext.WindowMgr.get("wndPreguntaMotivoIncompleta").close();
    }

});
