{
    "type": "Ext.window.Window",
    "reference": {
        "name": "items",
        "type": "array"
    },
    "codeClass": null,
    "userConfig": {
        "designer|userAlias": "DlgUploadCompra",
        "designer|userClassName": "DlgUploadCompra",
        "height": 655,
        "icon": "resources/cfdi.png",
        "layout": "border",
        "modal": true,
        "title": "Importar CFDI",
        "width": 1020
    },
    "name": "MyWindow",
    "designerId": "3fbc3c1d-e398-4887-a955-7c97a920575c",
    "viewControllerInstanceId": "eea4e80b-45ca-4044-b80f-95cf70e99e84",
    "viewModelInstanceId": "18c720af-9c6e-48ce-ad9a-1423064d2660",
    "cn": [
        {
            "type": "Ext.form.Panel",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "bodyPadding": 10,
                "height": 120,
                "id": "frmUpload",
                "layout|region": "north",
                "title": ""
            },
            "name": "MyForm4",
            "designerId": "46ddfcbe-9bd9-4192-8f0d-9bc2bea8b0e2",
            "cn": [
                {
                    "type": "Ext.toolbar.Toolbar",
                    "reference": {
                        "name": "dockedItems",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dock": "bottom"
                    },
                    "name": "MyToolbar14",
                    "designerId": "0856df70-dc9e-470b-b82d-736fdf4ec524",
                    "cn": [
                        {
                            "type": "Ext.toolbar.Fill",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "layout|flex": null
                            },
                            "name": "MyFill7",
                            "designerId": "d54e8897-db80-497b-84b5-d83bc0bb2712"
                        }
                    ]
                },
                {
                    "type": "Ext.panel.Panel",
                    "reference": {
                        "name": "items",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "container|columns": 4,
                        "layout": "table",
                        "title": ""
                    },
                    "name": "MyPanel4",
                    "designerId": "85b1a5f0-18d3-4e5f-b5f7-9d56284b6e80",
                    "cn": [
                        {
                            "type": "Ext.form.RadioGroup",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "columns": 1,
                                "fieldLabel": "",
                                "layout|rowspan": 2,
                                "vertical": true,
                                "width": 400
                            },
                            "name": "MyRadioGroup2",
                            "configAlternates": {
                                "columns": "number"
                            },
                            "designerId": "9caa38d8-bdda-4540-b113-0159d09cf1bc",
                            "cn": [
                                {
                                    "type": "Ext.form.field.Radio",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "boxLabel": "Revisar desde Correo",
                                        "checked": true,
                                        "fieldLabel": null,
                                        "inputValue": "1",
                                        "name": "rb"
                                    },
                                    "name": "MyRadio4",
                                    "designerId": "be3dee4a-2e37-4e30-aef5-30010aa44b3e"
                                },
                                {
                                    "type": "Ext.form.field.Radio",
                                    "reference": {
                                        "name": "items",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "boxLabel": "Cargar un archivo Local",
                                        "fieldLabel": null,
                                        "inputValue": "2",
                                        "name": "rb"
                                    },
                                    "name": "MyRadio5",
                                    "designerId": "b6d8875e-411f-4d74-b1dc-ab71349eb672"
                                },
                                {
                                    "type": "viewcontrollereventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onRadiogroupChange",
                                        "implHandler": [
                                            "console.log(newValue);",
                                            "window.currentCompraXML=null;",
                                            "Ext.ComponentMgr.get(\"gridXml\").getStore().removeAll();",
                                            "window.currentCompraXML=null;",
                                            "if (newValue[\"rb\"])",
                                            "    valor=newValue[\"rb\"];",
                                            "",
                                            "if (valor==\"1\"){ //Habilitar Buscar correo",
                                            "    Ext.ComponentMgr.get(\"btnCheckInbox\").setDisabled(false);",
                                            "    Ext.ComponentMgr.get(\"fileCompra\").setDisabled(true);",
                                            "    Ext.ComponentMgr.get(\"btnUploadCompra\").setDisabled(true);",
                                            "    Ext.ComponentMgr.get(\"lblCFDISeleccionado\").setText(\"\");",
                                            "",
                                            "}else if (valor==\"2\"){ //Habilitar Carga Local",
                                            "    Ext.ComponentMgr.get(\"btnCheckInbox\").setDisabled(true);",
                                            "    Ext.ComponentMgr.get(\"fileCompra\").setDisabled(false);",
                                            "    Ext.ComponentMgr.get(\"btnUploadCompra\").setDisabled(false);",
                                            "    Ext.ComponentMgr.get(\"lblCFDISeleccionado\").setText(\"\");",
                                            "}"
                                        ],
                                        "name": "change",
                                        "scope": "me"
                                    },
                                    "name": "onRadiogroupChange",
                                    "designerId": "3fac90c4-7acb-42bf-8de3-3538d1a5fc9e"
                                }
                            ]
                        },
                        {
                            "type": "Ext.button.Button",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "id": "btnCheckInbox",
                                "layout|colspan": null,
                                "padding": 1,
                                "text": "Revisar Correo"
                            },
                            "name": "MyButton15",
                            "designerId": "6bb7c24c-63e0-45d3-aae3-17eb40569847",
                            "cn": [
                                {
                                    "type": "viewcontrollereventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onBtnCheckInboxClick",
                                        "implHandler": [
                                            "            var wnd = Ext.create(\"almacen.view.DlgConsultaCompraXML\", {id:\"wndConsultaComprasXML\"});",
                                            "            wnd.currentController=this;",
                                            "            wnd.center();",
                                            "            wnd.show();"
                                        ],
                                        "name": "click",
                                        "scope": "me"
                                    },
                                    "name": "onBtnCheckInboxClick",
                                    "designerId": "cd282f8a-20bf-4df1-a4ef-a670b2955034"
                                }
                            ]
                        },
                        {
                            "type": "Ext.form.Label",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "id": "lblCFDISeleccionado",
                                "layout|colspan": 2,
                                "text": ""
                            },
                            "name": "MyLabel4",
                            "designerId": "b254fd67-e971-41cb-a9ef-3db3f0d61f1f"
                        },
                        {
                            "type": "Ext.form.field.File",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "disabled": true,
                                "fieldLabel": "Elegir Archivo",
                                "id": "fileCompra",
                                "inputId": null,
                                "layout|colspan": 2,
                                "margin": "",
                                "maxWidth": 500,
                                "minWidth": 180,
                                "name": "fileCompra",
                                "padding": 10
                            },
                            "name": "MyFileUpload",
                            "designerId": "a9185fae-6e92-4d13-ade9-1ce3cd8f275d"
                        },
                        {
                            "type": "Ext.button.Button",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "disabled": true,
                                "icon": "resources/upload.png",
                                "id": "btnUploadCompra",
                                "layout|colspan": 2,
                                "text": "Cargar"
                            },
                            "name": "MyButton46",
                            "designerId": "eb833a6b-b12f-4ec5-87fc-e05ab154013b"
                        }
                    ]
                }
            ]
        },
        {
            "type": "Ext.grid.Panel",
            "reference": {
                "name": "items",
                "type": "array"
            },
            "codeClass": null,
            "userConfig": {
                "id": "gridXml",
                "layout|region": "center",
                "store": "StoreCompraXML",
                "title": "Productos"
            },
            "name": "MyGridPanel12",
            "designerId": "6231a5c1-74eb-4369-b1d0-b62e2f2ad8e1",
            "cn": [
                {
                    "type": "Ext.grid.column.Number",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "xmlCantidad",
                        "defaultWidth": 55,
                        "maxWidth": 55,
                        "menuDisabled": true,
                        "minWidth": 55,
                        "tdCls": "x-change-cell",
                        "text": "Cant.",
                        "width": 55
                    },
                    "name": "MyNumberColumn22",
                    "designerId": "46aa0f8c-85d6-459c-877a-66a70431d607"
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "xmlNombreProducto",
                        "tdCls": "x-change-cell",
                        "text": "Descripcion",
                        "width": 172
                    },
                    "name": "MyColumn44",
                    "designerId": "c75b6f09-bb5b-4116-af19-2f7f9985600f"
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "unidad",
                        "defaultWidth": 50,
                        "maxWidth": 50,
                        "menuDisabled": true,
                        "minWidth": 50,
                        "tdCls": "x-change-cell",
                        "text": "Uni.",
                        "width": 50
                    },
                    "name": "MyColumn45",
                    "designerId": "b0a5434a-423a-48a5-8bdc-427de44674c9"
                },
                {
                    "type": "Ext.grid.column.Number",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "precioAnterior",
                        "defaultWidth": 65,
                        "maxWidth": 65,
                        "minWidth": 65,
                        "tdCls": "x-change-cell",
                        "text": "Costo",
                        "width": 65
                    },
                    "name": "MyNumberColumn23",
                    "designerId": "76f8ebc3-5763-48ef-94c4-ac5ec182a1db",
                    "cn": [
                        {
                            "type": "Ext.grid.filters.filter.Number",
                            "reference": {
                                "name": "filter",
                                "type": "object"
                            },
                            "codeClass": null,
                            "name": "MyNumberFilter15",
                            "designerId": "f3ad01af-674d-4c79-974b-abea20d0ac77"
                        },
                        {
                            "type": "basicfunction",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "designer|params": [
                                    "value",
                                    "metaData",
                                    "record",
                                    "rowIndex",
                                    "colIndex",
                                    "store",
                                    "view"
                                ],
                                "fn": "renderer",
                                "implHandler": [
                                    "return Ext.util.Format.currency(value);"
                                ]
                            },
                            "name": "renderer",
                            "designerId": "236b8639-c5f7-400f-a10d-6a94e5af4cdf"
                        }
                    ]
                },
                {
                    "type": "Ext.grid.column.Number",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "importe",
                        "defaultWidth": 65,
                        "maxWidth": 65,
                        "minWidth": 65,
                        "tdCls": "x-change-cell",
                        "text": "Importe",
                        "width": 65
                    },
                    "name": "MyNumberColumn24",
                    "designerId": "cc0df988-dd09-4ffc-9827-d53313ef6231",
                    "cn": [
                        {
                            "type": "Ext.grid.filters.filter.Number",
                            "reference": {
                                "name": "filter",
                                "type": "object"
                            },
                            "codeClass": null,
                            "name": "MyNumberFilter14",
                            "designerId": "d7e490d5-550f-4516-b75a-2773880da3ce"
                        },
                        {
                            "type": "basicfunction",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "designer|params": [
                                    "value",
                                    "metaData",
                                    "record",
                                    "rowIndex",
                                    "colIndex",
                                    "store",
                                    "view"
                                ],
                                "fn": "renderer",
                                "implHandler": [
                                    "return Ext.util.Format.currency(value);",
                                    ""
                                ]
                            },
                            "name": "renderer",
                            "designerId": "2b09da50-e463-4f46-a324-892ad38780c6"
                        }
                    ]
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "xmlNoIdentificacion",
                        "tdCls": "x-change-cell",
                        "text": "No. Identificación",
                        "width": 126
                    },
                    "name": "MyColumn47",
                    "designerId": "647b28e1-4781-44cb-a55d-fb09cc719a6a"
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "nombreproducto",
                        "defaultWidth": 180,
                        "maxWidth": 180,
                        "minWidth": 180,
                        "tdCls": "x-change-cell",
                        "text": "Producto",
                        "width": 180
                    },
                    "name": "MyColumn48",
                    "designerId": "521f0de4-f5e3-4289-9d2b-c5469ca4edb6"
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "xmlProporcionExterna",
                        "defaultWidth": 50,
                        "maxWidth": 50,
                        "menuDisabled": true,
                        "minWidth": 50,
                        "tdCls": "x-change-cell",
                        "text": "Prop",
                        "width": 50
                    },
                    "name": "MyColumn46",
                    "designerId": "a30c503b-388c-4a4d-a377-4c012d971784",
                    "cn": [
                        {
                            "type": "Ext.form.field.Number",
                            "reference": {
                                "name": "widget",
                                "type": "object"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "minValue": 0
                            },
                            "name": "MyNumberField9",
                            "designerId": "3903e39a-f896-4f30-b365-b25fd810f520"
                        }
                    ]
                },
                {
                    "type": "Ext.grid.column.Check",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "tieneImpuesto",
                        "defaultWidth": 50,
                        "hidden": true,
                        "maxWidth": 50,
                        "minWidth": 50,
                        "text": "IVA",
                        "width": 50
                    },
                    "name": "MyCheck1",
                    "designerId": "49f66ef8-12db-43ad-a310-ebd80e403fe2"
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "Impuesto",
                        "tdCls": "x-change-cell",
                        "text": "Impuesto"
                    },
                    "name": "MyColumn3",
                    "designerId": "50cd47a6-20e9-4cad-b35c-220b759f870c",
                    "cn": [
                        {
                            "type": "Ext.form.field.ComboBox",
                            "reference": {
                                "name": "editor",
                                "type": "object"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "allowBlank": false,
                                "autoSelect": false,
                                "displayField": "label",
                                "editable": false,
                                "forceSelection": true,
                                "id": "cmbImpuestoXML",
                                "queryMode": "local",
                                "selectOnTab": false,
                                "store": "StoreComboImpuestos",
                                "valueField": "value"
                            },
                            "name": "MyComboBox2",
                            "designerId": "ed234ac9-19fd-43b4-ad2b-2515224b4d2c",
                            "cn": [
                                {
                                    "type": "basiceventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onCmbImpuestoXMLBeforeRender",
                                        "implHandler": [
                                            "/*var request = new Object(); request.method=\"impuestos\"; request.params=[];",
                                            "request.params.push({\"name\":\"imei\",\"value\":almacen.getApplication().SessionId});",
                                            "almacen.getApplication().loadData(request,function(response){",
                                            "    component.getStore().loadData(response.items);",
                                            "    //Ext.ComponentMgr.get(\"comboImpuesto\").getPicker().loadMask.hide();",
                                            "});*/"
                                        ],
                                        "name": "beforerender",
                                        "scope": "me"
                                    },
                                    "name": "onCmbImpuestoXMLBeforeRender",
                                    "designerId": "eb80ce5f-e3cf-4bab-84dd-916a94c07c2d"
                                },
                                {
                                    "type": "basiceventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onCmbImpuestoXMLBeforeQuery",
                                        "implHandler": [
                                            "queryPlan.query = new RegExp(queryPlan.query, 'i');",
                                            "queryPlan.forceAll = true;"
                                        ],
                                        "name": "beforequery",
                                        "scope": "me"
                                    },
                                    "name": "onCmbImpuestoXMLBeforeQuery",
                                    "designerId": "ff3b7249-75f0-47e0-8b7f-f938a490f2c0"
                                }
                            ]
                        },
                        {
                            "type": "fixedfunction",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "designer|params": [
                                    "value",
                                    "metaData",
                                    "record",
                                    "rowIndex",
                                    "colIndex",
                                    "store",
                                    "view"
                                ],
                                "fn": "renderer",
                                "implHandler": [
                                    "rec = this.columns[colIndex].getEditor().getStore().findRecord(\"value\", value);",
                                    "if (rec){",
                                    "    return rec.get(\"label\");",
                                    "}else{",
                                    "    return \"Sin Impuesto\";",
                                    "}"
                                ]
                            },
                            "name": "renderer",
                            "designerId": "d1904a8e-bb98-4d45-987a-9ef2feed715d"
                        }
                    ]
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "idTasa",
                        "tdCls": "x-change-cell",
                        "text": "IEPS",
                        "width": 139
                    },
                    "name": "MyColumn",
                    "designerId": "1fcf99a0-3bce-4e0a-8b41-3b15de6035d1",
                    "cn": [
                        {
                            "type": "Ext.form.field.ComboBox",
                            "reference": {
                                "name": "editor",
                                "type": "object"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "autoSelect": false,
                                "displayField": "Descripcion",
                                "editable": false,
                                "forceSelection": true,
                                "id": "cmbIEPS",
                                "queryMode": "local",
                                "selectOnTab": false,
                                "store": "StoreTasasIEPS",
                                "valueField": "Id"
                            },
                            "name": "MyComboBox4",
                            "designerId": "8c79adbb-1b5a-48fe-a2b5-732d2631b72e",
                            "cn": [
                                {
                                    "type": "basiceventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onCmbIEPSBeforeRender",
                                        "implHandler": [
                                            "console.log(\"ejecutando listaieps en evento\");",
                                            "var request = new Object(); request.method=\"listaieps\"; request.params=[];",
                                            "request.params.push({\"name\":\"imei\",\"value\":almacen.getApplication().SessionId});",
                                            "almacen.getApplication().loadData(request,function(response){",
                                            "    component.getStore().loadData(response);",
                                            "    //Ext.ComponentMgr.get(\"comboImpuesto\").getPicker().loadMask.hide();",
                                            "});"
                                        ],
                                        "name": "beforerender",
                                        "scope": "me"
                                    },
                                    "name": "onCmbIEPSBeforeRender",
                                    "designerId": "c2d99fba-d1ea-4808-bb64-9f87b27e6820"
                                },
                                {
                                    "type": "basiceventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onCmbIEPSBeforeQuery",
                                        "implHandler": [
                                            "queryPlan.query = new RegExp(queryPlan.query, 'i');",
                                            "                 queryPlan.forceAll = true;"
                                        ],
                                        "name": "beforequery",
                                        "scope": "me"
                                    },
                                    "name": "onCmbIEPSBeforeQuery",
                                    "designerId": "f4a6d65d-af11-4150-ab4c-3184a09f6631"
                                },
                                {
                                    "type": "basiceventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onCmbIEPSSelect",
                                        "implHandler": [
                                            "rec = combo.up(\"editor\").editingPlugin.context.record;",
                                            "rec.beginEdit();",
                                            "rec.set(\"tasa\", records[0].data);",
                                            "rec.endEdit();"
                                        ],
                                        "name": "select",
                                        "scope": "me"
                                    },
                                    "name": "onCmbIEPSSelect",
                                    "designerId": "abde471e-ed2d-40cb-88d2-079cc797a062"
                                }
                            ]
                        },
                        {
                            "type": "fixedfunction",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "designer|params": [
                                    "value",
                                    "metaData",
                                    "record",
                                    "rowIndex",
                                    "colIndex",
                                    "store",
                                    "view"
                                ],
                                "fn": "renderer",
                                "implHandler": [
                                    "rec = this.columns[colIndex].getEditor().getStore().findRecord(\"Id\", value);",
                                    "if (rec){",
                                    "    return rec.get(\"Descripcion\");",
                                    "}else{",
                                    "    return \"Sin Impuesto\";",
                                    "}"
                                ]
                            },
                            "name": "renderer",
                            "designerId": "0722364f-9c84-4eac-a7e6-db0640ffe3c5"
                        }
                    ]
                },
                {
                    "type": "Ext.grid.column.Column",
                    "reference": {
                        "name": "columns",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dataIndex": "ie",
                        "id": "columnaie",
                        "tdCls": "x-change-cell",
                        "text": "IE"
                    },
                    "name": "MyColumn5",
                    "designerId": "bf6396e3-5952-4862-9b85-7043ab1af9be",
                    "cn": [
                        {
                            "type": "fixedfunction",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "designer|params": [
                                    "value",
                                    "metaData",
                                    "record",
                                    "rowIndex",
                                    "colIndex",
                                    "store",
                                    "view"
                                ],
                                "fn": "renderer",
                                "implHandler": [
                                    "rec = this.columns[colIndex].getEditor().getStore().findRecord(\"value\", value);",
                                    "if (rec){",
                                    "    return rec.get(\"label\");",
                                    "}else{",
                                    "    return \"Sin Impuesto\";",
                                    "}"
                                ]
                            },
                            "name": "renderer",
                            "designerId": "0b2e5a3a-0f76-4d8a-817a-a6a40defcd48"
                        },
                        {
                            "type": "Ext.form.field.ComboBox",
                            "reference": {
                                "name": "editor",
                                "type": "object"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "allowBlank": false,
                                "autoSelect": false,
                                "displayField": "label",
                                "editable": false,
                                "forceSelection": true,
                                "id": "cmbIE",
                                "queryMode": "local",
                                "selectOnTab": false,
                                "store": "StoreComboIE",
                                "valueField": "value"
                            },
                            "name": "MyComboBox1",
                            "designerId": "3dbbb9db-e8e4-4e44-b949-3efdfa277890",
                            "cn": [
                                {
                                    "type": "viewcontrollereventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onCmbIEBeforeRender",
                                        "implHandler": [
                                            "var activar=almacen.getApplication().currentSession.habilitaImpuestoIE;",
                                            "",
                                            "if(activar){",
                                            "    Ext.ComponentMgr.get(\"columnaie\").show();",
                                            "}else{",
                                            "    Ext.ComponentMgr.get(\"columnaie\").hide();",
                                            "}"
                                        ],
                                        "name": "beforerender",
                                        "scope": "me"
                                    },
                                    "name": "onCmbIEBeforeRender",
                                    "designerId": "e63323fd-369d-402c-8f72-8083edc66de1"
                                },
                                {
                                    "type": "viewcontrollereventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onCmbIEBeforeQuery",
                                        "implHandler": [
                                            "queryPlan.query = new RegExp(queryPlan.query, 'i');",
                                            "queryPlan.forceAll = true;"
                                        ],
                                        "name": "beforequery",
                                        "scope": "me"
                                    },
                                    "name": "onCmbIEBeforeQuery",
                                    "designerId": "911f45f5-5fbe-4feb-8cb2-1d942e6d5321"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "Ext.grid.View",
                    "reference": {
                        "name": "viewConfig",
                        "type": "object"
                    },
                    "codeClass": null,
                    "name": "MyGridView10",
                    "designerId": "b6aa9a0c-609e-45f8-a69e-3a1a909ecea8",
                    "cn": [
                        {
                            "type": "viewcontrollereventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onViewItemUpdate",
                                "implHandler": [
                                    "/*IvaAsignar=window.currentXxml.xmlIVAAsignar;",
                                    "Procesados = {};",
                                    "Ext.ComponentMgr.get(\"gridXml\").getStore().each(function(rec){",
                                    "",
                                    "    ImpuestoTotal=0;",
                                    "    console.log(\"procesados\");",
                                    "    console.log(Procesados);",
                                    "    console.log(\"ident\");",
                                    "    console.log(rec.get(\"xmlNoIdentificacion\"));",
                                    "    if (rec.get(\"tieneImpuesto\") && !Procesados[rec.get(\"xmlNoIdentificacion\")]){",
                                    "        Procesados[rec.get(\"xmlNoIdentificacion\")]=true;",
                                    "        Impuesto = 0;",
                                    "        PrecioTotal=rec.get(\"importe\");",
                                    "        Impuesto = PrecioTotal * .16;",
                                    "        ImpuestoTotal+=Impuesto;",
                                    "        IvaAsignar -= Impuesto;",
                                    "    }",
                                    "});",
                                    "",
                                    " Ext.ComponentMgr.get(\"fldIVA\").setValue(IvaAsignar);",
                                    "if ((IvaAsignar > 0.01) || (IvaAsignar < 0))",
                                    "Ext.ComponentMgr.get(\"fldIVA\").setFieldStyle(\"color: red;\");",
                                    "else",
                                    "    Ext.ComponentMgr.get(\"fldIVA\").setFieldStyle(\"color: green;\");*/",
                                    "this.actualizaIVA();",
                                    ""
                                ],
                                "name": "itemupdate",
                                "scope": "me"
                            },
                            "name": "onViewItemUpdate",
                            "designerId": "d43d2c6b-dadc-4fca-97d8-f371bba6589a"
                        },
                        {
                            "type": "viewcontrollereventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onViewItemDblClick",
                                "implHandler": [
                                    "this.MuestraDialogoAsociar(record);"
                                ],
                                "name": "itemdblclick",
                                "scope": "me"
                            },
                            "name": "onViewItemDblClick",
                            "designerId": "e72fdbdf-f176-4b80-a40b-1027b07cb14b"
                        },
                        {
                            "type": "fixedfunction",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "designer|params": [
                                    "record",
                                    "rowIndex",
                                    "rowParams",
                                    "store"
                                ],
                                "fn": "getRowClass",
                                "implHandler": [
                                    "return (record.get(\"xmlProporcionExterna\")<=0) ?  \"no-inventory\" : \"\";"
                                ]
                            },
                            "name": "getRowClass",
                            "designerId": "3c00fee3-2516-468f-a7a9-8d957282045b"
                        }
                    ]
                },
                {
                    "type": "Ext.toolbar.Toolbar",
                    "reference": {
                        "name": "dockedItems",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "dock": "bottom"
                    },
                    "name": "MyToolbar15",
                    "designerId": "e4c5c18e-4a9a-4138-9922-fd264665fdba",
                    "cn": [
                        {
                            "type": "Ext.toolbar.Fill",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "layout|flex": null
                            },
                            "name": "MyFill8",
                            "designerId": "2b10167d-8e76-4bbf-9d6f-cedaae194495"
                        },
                        {
                            "type": "Ext.form.field.Number",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fieldLabel": "IE Asignar",
                                "hideEmptyLabel": false,
                                "id": "fldIE",
                                "labelWidth": 70,
                                "layout|flex": null,
                                "maxWidth": 150,
                                "minWidth": 150,
                                "readOnly": true,
                                "width": 150
                            },
                            "name": "MyNumberField1",
                            "designerId": "ad860620-d841-4f7d-a2dd-678a8d293613",
                            "cn": [
                                {
                                    "type": "viewcontrollereventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onFldIEAfterRender",
                                        "implHandler": [
                                            "var activar=almacen.getApplication().currentSession.habilitaImpuestoIE;",
                                            "",
                                            "if(activar){",
                                            "    Ext.ComponentMgr.get(\"fldIE\").show();",
                                            "}else{",
                                            "    Ext.ComponentMgr.get(\"fldIE\").hide();",
                                            "}"
                                        ],
                                        "name": "afterrender",
                                        "scope": "me"
                                    },
                                    "name": "onFldIEAfterRender",
                                    "designerId": "e934e5cd-b32e-4dd2-8233-dae5d52ae53e"
                                }
                            ]
                        },
                        {
                            "type": "Ext.form.field.Number",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fieldLabel": "IVA Asignar",
                                "hideEmptyLabel": false,
                                "id": "fldIVA",
                                "labelWidth": 80,
                                "layout|flex": null,
                                "maxWidth": 150,
                                "minWidth": 150,
                                "readOnly": true,
                                "width": 150
                            },
                            "name": "MyNumberField10",
                            "designerId": "2ab6f5b7-ca46-4fee-bf1e-f4300cabc6bf"
                        },
                        {
                            "type": "Ext.form.field.Number",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fieldLabel": "IEPS Asignar",
                                "id": "fldIEPS",
                                "labelWidth": 85,
                                "layout|flex": null,
                                "maxWidth": 170,
                                "minWidth": 170,
                                "readOnly": true,
                                "width": 170
                            },
                            "name": "MyNumberField12",
                            "designerId": "da60453b-beaa-46af-8684-546167c8dc15"
                        },
                        {
                            "type": "Ext.form.field.Number",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fieldLabel": "Retencion",
                                "id": "fldRetencion",
                                "labelWidth": 60,
                                "layout|flex": null,
                                "maxWidth": 150,
                                "minWidth": 150,
                                "readOnly": true,
                                "width": 150
                            },
                            "name": "MyNumberField11",
                            "designerId": "9e388232-3006-4bae-bb65-757daa4b63c5"
                        },
                        {
                            "type": "Ext.form.field.Number",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fieldLabel": "Prods. Asignar",
                                "hideTrigger": true,
                                "id": "fldPRODS",
                                "keyNavEnabled": false,
                                "labelWidth": 95,
                                "layout|flex": null,
                                "maxWidth": 175,
                                "minWidth": 175,
                                "mouseWheelEnabled": false,
                                "readOnly": true,
                                "repeatTriggerClick": false,
                                "spinDownEnabled": false,
                                "spinUpEnabled": false,
                                "width": 175
                            },
                            "name": "MyNumberField16",
                            "designerId": "f8e2733d-9fb2-4ed4-9baa-d6505eaacbb4"
                        },
                        {
                            "type": "Ext.button.Button",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "icon": "resources/merge.png",
                                "layout|flex": null,
                                "text": "Asociar"
                            },
                            "name": "MyButton50",
                            "designerId": "3db7d7fe-63ec-41e4-adeb-878ce3f0469d",
                            "cn": [
                                {
                                    "type": "viewcontrollereventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onButtonClick",
                                        "implHandler": [
                                            "    if (Ext.ComponentMgr.get(\"gridXml\").getSelection().length <= 0) return false;",
                                            "this.MuestraDialogoAsociar(Ext.ComponentMgr.get(\"gridXml\").getSelection()[0]);"
                                        ],
                                        "name": "click",
                                        "scope": "me"
                                    },
                                    "name": "onButtonClick",
                                    "designerId": "dd546f47-7029-4441-816a-34e31d132ab6"
                                }
                            ]
                        },
                        {
                            "type": "Ext.button.Button",
                            "reference": {
                                "name": "items",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "icon": "resources/import.png",
                                "id": "btnImport",
                                "layout|flex": null,
                                "text": "Importar"
                            },
                            "name": "MyButton48",
                            "designerId": "cdaa9ff2-178e-438b-9bdd-ea5c5943a6a7",
                            "cn": [
                                {
                                    "type": "viewcontrollereventbinding",
                                    "reference": {
                                        "name": "listeners",
                                        "type": "array"
                                    },
                                    "codeClass": null,
                                    "userConfig": {
                                        "fn": "onBtnImportClick",
                                        "implHandler": [
                                            "IvaAsignar=Ext.ComponentMgr.get(\"fldIVA\").getValue();",
                                            "IEPSAsignar=Ext.ComponentMgr.get(\"fldIEPS\").getValue();",
                                            "PRODAsignar=Ext.ComponentMgr.get(\"fldPRODS\").getValue();",
                                            "IEAsignar=Ext.ComponentMgr.get(\"fldIE\").getValue();",
                                            "MsgError=\"\";",
                                            "if (PRODAsignar > 0) MsgError+=\"<li>Faltan productos por asignar, complete la asociación de los productos </li>\";",
                                            "if (((IEPSAsignar >= 1) || (IEPSAsignar <= -1))) MsgError+=\"<li>La diferencia de IEPS debe ser menor a 1MXN, verifique asignación de tasa </li>\";",
                                            "if (((IvaAsignar >= 1) || (IvaAsignar <= -1))) MsgError+=\"<li>La diferencia de IVA debe ser menor a 1MXN, verifique asignación de IVA </li>\";",
                                            "if (((IEAsignar >= 1) || (IEAsignar <= -1))) MsgError+=\"<li>La diferencia de IE debe ser menor a 1MXN, verifique asignación de IE </li>\";",
                                            "if (MsgError > \" \"){",
                                            "    Ext.Msg.alert('Verifique la información', \"<ul>\"+MsgError + \"</ul>\");",
                                            "    return false;",
                                            "}",
                                            "window.currentXxml.productosCompraAgregar=[];",
                                            "Ext.ComponentMgr.get(\"gridXml\").getStore().each(function(rec){",
                                            "    window.currentXxml.productosCompraAgregar.push(rec.data);",
                                            "",
                                            "});",
                                            "var currentController =  Ext.WindowManager.get(\"wndUploadCompra\").parentController;",
                                            "var request = new Object();",
                                            "request.method=\"importacompracomprobante\";",
                                            "request.params=[];",
                                            "request.params.push({\"name\":\"imei\",\"value\":almacen.getApplication().SessionId});",
                                            "request.params.push({\"name\":\"data\",\"value\":Ext.encode(window.currentXxml)});",
                                            "var controller = this;",
                                            "almacen.getApplication().loadData(request,function(response){",
                                            "",
                                            "    //currentController.loadConsultaTraspasos(null,null);",
                                            "    if (Ext.WindowManager.get(\"wndUploadCompra\"))",
                                            "        Ext.WindowManager.get(\"wndUploadCompra\").close();",
                                            "",
                                            "    console.log(\"el response \");",
                                            "    console.log(response);",
                                            "    console.log(\"currentCompraXML \", window.currentCompraXML);",
                                            "",
                                            "    if (window.currentCompraXML)",
                                            "        currentController.ImportaCompra(response, window.currentCompraXML);",
                                            "    else",
                                            "        currentController.ImportaCompra(response);",
                                            "",
                                            "    currentController.readOnly=false;",
                                            "",
                                            "    //Ext.ComponentMgr.get(\"comboProveedor\").getPicker().loadMask.hide();",
                                            "    console.log(\"despues de enviar\");",
                                            "});"
                                        ],
                                        "name": "click",
                                        "scope": "me"
                                    },
                                    "name": "onBtnImportClick",
                                    "designerId": "26f15a3b-1dbf-4221-b364-6c60b161af4e"
                                }
                            ]
                        }
                    ]
                },
                {
                    "type": "viewcontrollereventbinding",
                    "reference": {
                        "name": "listeners",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "fn": "onGridXmlShow",
                        "implHandler": [
                            "component.getStore().removeAll();"
                        ],
                        "name": "show",
                        "scope": "me"
                    },
                    "name": "onGridXmlShow",
                    "designerId": "cc0c1c52-d742-4464-8b48-01af194115bd"
                },
                {
                    "type": "Ext.grid.plugin.CellEditing",
                    "reference": {
                        "name": "plugins",
                        "type": "array"
                    },
                    "codeClass": null,
                    "userConfig": {
                        "clicksToEdit": 1
                    },
                    "name": "MyCellEditingPlugin3",
                    "designerId": "e0ce8cf0-9e6c-4b20-b6a9-37ac0fb3dc15",
                    "cn": [
                        {
                            "type": "viewcontrollereventbinding",
                            "reference": {
                                "name": "listeners",
                                "type": "array"
                            },
                            "codeClass": null,
                            "userConfig": {
                                "fn": "onCellEditingEdit",
                                "name": "edit",
                                "scope": "me"
                            },
                            "name": "onCellEditingEdit",
                            "designerId": "be6d2ee0-38c6-46f5-8237-9f20b1b59859"
                        }
                    ]
                },
                {
                    "type": "Ext.grid.filters.Filters",
                    "reference": {
                        "name": "plugins",
                        "type": "array"
                    },
                    "codeClass": null,
                    "name": "MyGridFiltersPlugin8",
                    "designerId": "486c92e0-316c-4e45-a70f-bd34d1992045"
                }
            ]
        }
    ]
}